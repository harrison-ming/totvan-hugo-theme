{{ define "main" }}

{{- partial "content/breadcrumb.html" . -}}

  <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-14">

  <section class="md:col-span-2">

    <h2 class="text-2xl font-bold mb-6">{{ .Title | humanize }}</h2>

    {{- /* è·å–é…ç½®å‚æ•° */ -}}
    {{- $minArticles := site.Params.categoryPage.minArticles | default 20 -}}
    {{- $showLowFrequency := site.Params.categoryPage.showLowFrequency | default true -}}

    {{- /* ç»Ÿè®¡åˆ†ç±»æ•°é‡ */ -}}
    {{- $totalCategories := len .Data.Terms -}}
    {{- $highFreqCount := 0 -}}
    {{- range .Data.Terms.ByCount -}}
      {{- if ge .Count $minArticles -}}
        {{- $highFreqCount = add $highFreqCount 1 -}}
      {{- end -}}
    {{- end -}}
    {{- $lowFreqCount := sub $totalCategories $highFreqCount -}}

    {{- /* é«˜é¢‘åˆ†ç±»åŒºåŸŸ */ -}}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">

      {{- range .Data.Terms.ByCount -}}
        {{- if ge .Count $minArticles -}}

        <a href="{{ .Page.RelPermalink }}" class="category-card bg-white border border-gray-200 rounded-xl p-4 transition-all hover:bg-primary-50 hover:border-primary-500 hover:shadow-md hover:-translate-y-1 flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div class="category-icon w-8 h-8 rounded-full flex items-center justify-center text-white text-base flex-shrink-0" style="background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);">
              {{ $categoryName := .Page.LinkTitle | lower }}
              {{ if or (in $categoryName "æ—¶äº‹") (in $categoryName "æ–°é—»") }}ğŸ“°
              {{ else if or (in $categoryName "ç”Ÿæ´»") (in $categoryName "ç¤¾åŒº") }}ğŸ 
              {{ else if or (in $categoryName "æ–‡åŒ–") (in $categoryName "è‰ºæœ¯") }}ğŸ¨
              {{ else if or (in $categoryName "ä½“è‚²") (in $categoryName "è¿åŠ¨") }}âš½
              {{ else if or (in $categoryName "æ”¿æ²»") (in $categoryName "é€‰ä¸¾") }}ğŸ›ï¸
              {{ else if or (in $categoryName "ç»æµ") (in $categoryName "è´¢ç»") (in $categoryName "æˆ¿åœ°äº§") }}ğŸ’¼
              {{ else if or (in $categoryName "å¥åº·") (in $categoryName "åŒ»ç–—") }}ğŸ¥
              {{ else if or (in $categoryName "æ³•å¾‹") (in $categoryName "å¸æ³•") }}âš–ï¸
              {{ else if or (in $categoryName "æ—…æ¸¸") (in $categoryName "æ—…è¡Œ") }}âœˆï¸
              {{ else if or (in $categoryName "ç¾é£Ÿ") (in $categoryName "é¤é¥®") }}ğŸ½ï¸
              {{ else if or (in $categoryName "æ•™è‚²") (in $categoryName "å­¦æ ¡") }}ğŸ“š
              {{ else if or (in $categoryName "ç§‘æŠ€") (in $categoryName "æŠ€æœ¯") }}ğŸ’»
              {{ else if or (in $categoryName "å¨±ä¹") (in $categoryName "ç”µå½±") (in $categoryName "éŸ³ä¹") }}ğŸ¬
              {{ else if or (in $categoryName "ç¯å¢ƒ") (in $categoryName "æ°”å€™") }}ğŸŒ
              {{ else if or (in $categoryName "äº¤é€š") (in $categoryName "è¿è¾“") }}ğŸš—
              {{ else if in $categoryName "å¤©æ°”" }}ğŸŒ¤ï¸
              {{ else if or (in $categoryName "çŠ¯ç½ª") (in $categoryName "å®‰å…¨") }}ğŸš¨
              {{ else if in $categoryName "æ´»åŠ¨" }}ğŸ‰
              {{ else }}ğŸ“
              {{ end }}
            </div>
            <span class="font-semibold text-gray-900">{{ .Page.LinkTitle | humanize }}</span>
          </div>
          <span class="category-count bg-primary-100 text-primary-800 px-3 py-1 rounded-full text-xs font-medium min-w-10 text-center">{{ .Count }}</span>
        </a>

        {{- end -}}
      {{- end -}}

    </div>

    {{- /* ä½é¢‘åˆ†ç±»åŒºåŸŸï¼ˆå¯æŠ˜å ï¼‰ */ -}}
    {{- if and $showLowFrequency (gt $lowFreqCount 0) -}}

    <!-- æŠ˜å åŒºåŸŸ -->
    <details class="group mt-8">
      <summary class="flex items-center text-lg font-medium text-primary-600 hover:text-primary-700 transition-colors py-3 px-4 bg-primary-50 rounded-lg cursor-pointer" style="list-style: none;">
        <svg class="mr-2 transition-transform group-open:rotate-90" width="20" height="20" fill="currentColor" viewBox="0 0 20 20" style="min-width: 20px; min-height: 20px; max-width: 20px; max-height: 20px;">
          <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
        </svg>
        <span>ğŸ“‚ æŸ¥çœ‹æ›´å¤šåˆ†ç±» <span class="text-gray-600">(è¿˜æœ‰ {{ $lowFreqCount }} ä¸ª)</span></span>
      </summary>

      <div class="mt-6">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">

          {{- range .Data.Terms.ByCount -}}
            {{- if lt .Count $minArticles -}}

            <a href="{{ .Page.RelPermalink }}" class="category-card bg-white border border-gray-200 rounded-xl p-4 transition-all hover:bg-primary-50 hover:border-primary-500 hover:shadow-md hover:-translate-y-1 flex items-center justify-between">
              <div class="flex items-center gap-3">
                <div class="category-icon w-8 h-8 rounded-full flex items-center justify-center text-white text-base flex-shrink-0" style="background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);">
                  {{ $categoryName := .Page.LinkTitle | lower }}
                  {{ if or (in $categoryName "æ—¶äº‹") (in $categoryName "æ–°é—»") }}ğŸ“°
                  {{ else if or (in $categoryName "ç”Ÿæ´»") (in $categoryName "ç¤¾åŒº") }}ğŸ 
                  {{ else if or (in $categoryName "æ–‡åŒ–") (in $categoryName "è‰ºæœ¯") }}ğŸ¨
                  {{ else if or (in $categoryName "ä½“è‚²") (in $categoryName "è¿åŠ¨") }}âš½
                  {{ else if or (in $categoryName "æ”¿æ²»") (in $categoryName "é€‰ä¸¾") }}ğŸ›ï¸
                  {{ else if or (in $categoryName "ç»æµ") (in $categoryName "è´¢ç»") (in $categoryName "æˆ¿åœ°äº§") }}ğŸ’¼
                  {{ else if or (in $categoryName "å¥åº·") (in $categoryName "åŒ»ç–—") }}ğŸ¥
                  {{ else if or (in $categoryName "æ³•å¾‹") (in $categoryName "å¸æ³•") }}âš–ï¸
                  {{ else if or (in $categoryName "æ—…æ¸¸") (in $categoryName "æ—…è¡Œ") }}âœˆï¸
                  {{ else if or (in $categoryName "ç¾é£Ÿ") (in $categoryName "é¤é¥®") }}ğŸ½ï¸
                  {{ else if or (in $categoryName "æ•™è‚²") (in $categoryName "å­¦æ ¡") }}ğŸ“š
                  {{ else if or (in $categoryName "ç§‘æŠ€") (in $categoryName "æŠ€æœ¯") }}ğŸ’»
                  {{ else if or (in $categoryName "å¨±ä¹") (in $categoryName "ç”µå½±") (in $categoryName "éŸ³ä¹") }}ğŸ¬
                  {{ else if or (in $categoryName "ç¯å¢ƒ") (in $categoryName "æ°”å€™") }}ğŸŒ
                  {{ else if or (in $categoryName "äº¤é€š") (in $categoryName "è¿è¾“") }}ğŸš—
                  {{ else if in $categoryName "å¤©æ°”" }}ğŸŒ¤ï¸
                  {{ else if or (in $categoryName "çŠ¯ç½ª") (in $categoryName "å®‰å…¨") }}ğŸš¨
                  {{ else if in $categoryName "æ´»åŠ¨" }}ğŸ‰
                  {{ else }}ğŸ“
                  {{ end }}
                </div>
                <span class="font-semibold text-gray-900">{{ .Page.LinkTitle | humanize }}</span>
              </div>
              <span class="category-count bg-primary-100 text-primary-800 px-3 py-1 rounded-full text-xs font-medium min-w-10 text-center">{{ .Count }}</span>
            </a>

            {{- end -}}
          {{- end -}}

        </div>
      </div>
    </details>

    <!-- åº•éƒ¨æç¤º -->
    <div class="mt-8 p-4 bg-blue-50 border border-blue-200 rounded-lg">
      <p class="text-sm text-blue-800">
        ğŸ’¡ <strong>æç¤ºï¼š</strong>é¡µé¢é»˜è®¤æ˜¾ç¤ºæ–‡ç« æ•° â‰¥ {{ $minArticles }} ç¯‡çš„åˆ†ç±»ï¼Œç‚¹å‡»"æŸ¥çœ‹æ›´å¤šåˆ†ç±»"å¯æŸ¥çœ‹å…¨éƒ¨ {{ $totalCategories }} ä¸ªåˆ†ç±»ã€‚
      </p>
    </div>

    {{- end -}}

  </section>

  <aside class="md:col-span-1">

    {{- partial "content/aside.html" . -}}

  </aside>

  </div>

{{ end }}
