{{- /*
  ToTVan Homepage Router

  这个文件根据配置参数选择合适的首页布局模板。

  配置:
    params.homepage.layout - 首页布局类型，可选值:
      - "category-grid" (默认) - 分类网格布局
      - "magazine" - 杂志风格布局
      - "minimal" - 极简文字布局
      - "hero-featured" - Hero + 特色文章布局

  示例配置 (hugo.toml):
    [params.homepage]
      layout = "magazine"

  向后兼容:
    如果未设置 params.homepage.layout，默认使用 category-grid 布局，
    这与 v0.1.0 的行为一致。
*/ -}}

{{- /* 获取首页布局配置 */ -}}
{{- $layout := site.Params.homepage.layout | default "category-grid" -}}

{{- /* 验证布局选择 */ -}}
{{- $validLayouts := slice "category-grid" "magazine" "minimal" "hero-featured" -}}
{{- if not (in $validLayouts $layout) -}}
  {{- warnf "Invalid homepage layout '%s'. Valid options are: %s. Using 'category-grid' as fallback." $layout (delimit $validLayouts ", ") -}}
  {{- $layout = "category-grid" -}}
{{- end -}}

{{- /* 路由到对应的布局模板 */ -}}
{{- $layoutTemplate := printf "home-layouts/%s.html" $layout -}}

{{- if templates.Exists (printf "partials/%s" $layoutTemplate) -}}
  {{- partial $layoutTemplate . -}}
{{- else -}}
  {{- /* 回退到 category-grid */ -}}
  {{- warnf "Homepage layout template '%s' not found. Using 'category-grid' as fallback." $layoutTemplate -}}
  {{- partial "home-layouts/category-grid.html" . -}}
{{- end -}}
